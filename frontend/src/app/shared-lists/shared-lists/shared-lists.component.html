<h2>Listas compartidas contigo</h2>

<mat-progress-spinner
  *ngIf="isLoading"
  mode="indeterminate"
  diameter="40"
></mat-progress-spinner>

<div *ngIf="!isLoading && errorMessage" class="error">
  {{ errorMessage }}
</div>

<div *ngIf="!isLoading && !errorMessage && pagedLists.length === 0">
  No tienes listas compartidas.
</div>

<mat-accordion *ngIf="pagedLists.length > 0">
  <mat-expansion-panel
    *ngFor="let list of pagedLists; let i = index"
    [expanded]="isExpanded(i)"
  >
    <mat-expansion-panel-header (click)="toggle(i)">
      <mat-panel-title>
        {{ list.name }} ({{ list.products.length }} producto{{
          list.products.length !== 1 ? "s" : ""
        }})
      </mat-panel-title>
    </mat-expansion-panel-header>

    <ul *ngIf="list.products.length > 0; else sinProductos">
      <li *ngFor="let product of list.products">
        <button
          mat-icon-button
          (click)="togglePurchased(product)"
          matTooltip="Marcar como comprado"
        >
          <mat-icon [color]="product.purchased ? 'primary' : 'warn'">
            {{ product.purchased ? "check_circle" : "radio_button_unchecked" }}
          </mat-icon>
        </button>
        <span>{{ product.name }} (x{{ product.quantity }})</span>
      </li>
    </ul>

    <ng-template #sinProductos>
      <p>Esta lista no tiene productos.</p>
    </ng-template>
  </mat-expansion-panel>
</mat-accordion>

<mat-paginator
  [length]="lists.length"
  [pageSize]="pageSize"
  [pageIndex]="pageIndex"
  [pageSizeOptions]="[5, 10, 20]"
  (page)="onPageChange($event)"
>
</mat-paginator>
